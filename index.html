<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>信用卡回饋神隊友 (超商補完版)</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@500;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --fresh-bg: #F8FAFC;
            --fresh-text: #334155;
        }
        
        body { 
            font-family: 'DM Sans', 'Noto Sans TC', sans-serif; 
            background-color: var(--fresh-bg); 
            color: var(--fresh-text);
            letter-spacing: 0.03em;
            height: 100dvh; 
            overflow: hidden;
        }
        
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .fade-enter-active, .fade-leave-active { transition: opacity 0.25s ease, transform 0.25s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; transform: translateY(10px); }

        .rate-number { font-family: 'DM Sans', sans-serif; letter-spacing: -0.04em; }
    </style>
</head>
<body>

    <div id="app" class="flex flex-col h-[100dvh] max-w-md mx-auto bg-[var(--fresh-bg)] shadow-2xl relative">
        
        <header class="bg-white pt-6 pb-3 px-5 z-30 sticky top-0 border-b border-slate-100 shadow-[0_4px_15px_-10px_rgba(0,0,0,0.05)]">
            <h1 class="text-xl font-bold tracking-wide text-slate-800 flex items-center">
                <i class="fa-solid fa-credit-card text-teal-500 mr-2"></i>回饋查詢
            </h1>
        </header>

        <div class="px-5 py-3 bg-white z-20 border-b border-slate-50">
            <div class="relative group">
                <i class="fa-solid fa-magnifying-glass absolute left-4 top-3.5 text-slate-400 group-focus-within:text-teal-500 transition-colors"></i>
                <input 
                    v-model="searchQuery" 
                    @input="handleInput"
                    type="text" 
                    placeholder="輸入關鍵字 (例: 7-11, 全家, 日本...)" 
                    class="w-full pl-11 pr-10 py-3 rounded-xl bg-slate-50 border border-slate-100 focus:bg-white focus:border-teal-200 focus:ring-2 focus:ring-teal-50 transition-all text-slate-700 outline-none placeholder-slate-400 text-base"
                >
                <button v-if="searchQuery" @click="clearSearch" class="absolute right-3 top-3.5 text-slate-300 p-1 hover:text-slate-500">
                    <i class="fa-solid fa-xmark text-lg"></i>
                </button>
            </div>
        </div>

        <div class="flex-1 overflow-y-auto hide-scrollbar p-5 pb-32 relative z-0">
            
            <div v-if="!searchQuery && !selectedMerchant" class="mt-2">
                <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3 ml-1">Popular</h3>
                <div class="flex flex-wrap gap-2">
                    <button v-for="tag in popularSearches" @click="quickSearch(tag)" 
                            class="px-4 py-2 bg-white border border-slate-200 rounded-lg text-slate-600 text-sm font-medium hover:border-teal-400 hover:text-teal-600 transition-colors">
                        {{ tag }}
                    </button>
                </div>
            </div>

            <div v-if="searchQuery && !selectedMerchant" class="space-y-3">
                <div v-for="m in filteredMerchants" :key="m.name" @click="selectMerchant(m)" 
                     class="bg-white p-4 rounded-xl border border-slate-100 shadow-sm hover:border-teal-300 transition-all cursor-pointer flex justify-between items-center">
                    <div class="flex items-center gap-3 overflow-hidden">
                        <div class="w-10 h-10 rounded-lg flex-shrink-0 flex items-center justify-center text-lg" 
                             :class="getIconColor(m.category)">
                            <i :class="getIconClass(m.category)"></i>
                        </div>
                        <div class="min-w-0">
                            <span class="font-bold text-base text-slate-700 block truncate">{{ m.name }}</span>
                            <span class="text-xs text-slate-400 block truncate">{{ m.category }}</span>
                        </div>
                    </div>
                    <i class="fa-solid fa-chevron-right text-slate-300 text-xs"></i>
                </div>
                
                <div v-if="filteredMerchants.length === 0" class="text-center mt-10 text-slate-400 text-sm">
                    <p>找不到「{{searchQuery}}」的結果<br>建議輸入品牌名稱或類別</p>
                </div>
            </div>

            <transition name="fade">
                <div v-if="selectedMerchant">
                    <button @click="backToSearch" class="mb-4 flex items-center text-slate-500 hover:text-teal-600 transition text-sm font-medium">
                        <i class="fa-solid fa-arrow-left mr-2"></i> 返回搜尋
                    </button>

                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 break-words leading-tight">{{ selectedMerchant.name }}</h2>
                        <span class="text-xs font-medium text-slate-400 bg-slate-100 px-2 py-0.5 rounded ml-0.5 inline-block mt-1">{{ selectedMerchant.category }}</span>
                    </div>

                    <div class="space-y-4">
                        <div v-for="(card, index) in sortedRewards" :key="index" 
                             class="bg-white rounded-2xl p-5 shadow-[0_4px_20px_-4px_rgba(203,213,225,0.5)] border border-slate-100 relative overflow-hidden"
                             :class="{'ring-1 ring-yellow-400': index === 0}">
                            
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h3 class="font-bold text-lg flex items-center gap-2" :class="getTextColorClass(card.cardName)">
                                        {{ card.cardName }}
                                    </h3>
                                </div>
                                
                                <div class="flex flex-col items-end">
                                    <div v-if="index === 0" class="bg-yellow-100 text-yellow-700 text-[10px] font-bold px-2 py-0.5 rounded-full mb-1">
                                        <i class="fa-solid fa-crown mr-1"></i>BEST
                                    </div>
                                    <div class="rate-number text-4xl font-bold leading-none" :class="getRateColorClass(card.cardName)">
                                        {{ card.rate }}<span class="text-lg font-medium ml-0.5 text-slate-400">%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="h-px bg-slate-50 w-full mb-3"></div>

                            <div class="flex flex-wrap gap-2 mb-3">
                                <span class="px-3 py-1.5 rounded-lg text-xs font-medium bg-slate-50 text-slate-600 border border-slate-100">
                                    {{ card.plan }}
                                </span>
                                <span class="px-3 py-1.5 rounded-lg text-xs font-medium border" 
                                      :class="getMethodTagClass(card.method)">
                                    {{ card.method }}
                                </span>
                            </div>

                            <div v-if="card.note" class="flex items-start gap-1.5 text-xs text-slate-400 font-light leading-relaxed bg-slate-50/50 p-2 rounded-lg">
                                <i class="fa-solid fa-circle-info mt-0.5 text-slate-300 flex-shrink-0"></i>
                                <span class="break-words">{{ card.note }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </transition>

        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    searchQuery: '',
                    selectedMerchant: null,
                    popularSearches: ['7-11', '全家', '新光三越', '星宇', '日本'],
                    
                    // ==========================================
                    // 旗艦版資料庫：全獨立、海量資料
                    // ==========================================
                    merchants: [
                        // --- 便利商店 (新!) ---
                        {
                            name: "7-ELEVEN",
                            category: "便利商店",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "天天刷", method: "台新Pay", rate: 3.8, note: "注意！必須綁定「台新Pay」掃碼支付，刷實體卡僅 0.3%。" },
                                { cardName: "國泰 Cube", plan: "集精選", method: "OPEN錢包/ICASH", rate: 3.0, note: "需切換至 [集精選]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "Line Pay", rate: 0, note: "超商大多排除在回饋之外，或回饋極低。" }
                            ]
                        },
                        {
                            name: "FamilyMart 全家便利商店",
                            category: "便利商店",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "天天刷", method: "台新Pay", rate: 3.8, note: "注意！必須綁定「台新Pay」掃碼支付，刷實體卡僅 0.3%。" },
                                { cardName: "國泰 Cube", plan: "集精選", method: "FamiPay", rate: 3.0, note: "需切換至 [集精選]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "Line Pay", rate: 0, note: "超商大多排除在回饋之外。" }
                            ]
                        },
                        {
                            name: "Hi-Life 萊爾富",
                            category: "便利商店",
                            rewards: [
                                { cardName: "富邦 J 卡", plan: "一般", method: "HiPay", rate: 0, note: "一般消費排除超商，建議使用其他支付工具。" },
                                { cardName: "國泰 Cube", plan: "一般", method: "實體卡", rate: 0.3, note: "萊爾富不在 [集精選] 名單中，僅一般回饋。" },
                                { cardName: "台新玫瑰太陽", plan: "一般", method: "實體卡", rate: 0.3, note: "萊爾富不在 [天天刷] 名單中，僅一般回饋。" }
                            ]
                        },
                        {
                            name: "OK Mart OK超商",
                            category: "便利商店",
                            rewards: [
                                { cardName: "富邦 J 卡", plan: "一般", method: "Line Pay", rate: 0, note: "超商不列入一般回饋。" },
                                { cardName: "國泰 Cube", plan: "一般", method: "實體卡", rate: 0.3, note: "OK超商不在 [集精選] 名單中。" },
                                { cardName: "台新玫瑰太陽", plan: "一般", method: "實體卡", rate: 0.3, note: "OK超商不在 [天天刷] 名單中。" }
                            ]
                        },

                        // --- 影城 ---
                        {
                            name: "新光影城 Shin Kong Cinemas",
                            category: "電影院",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "權益折扣", method: "實體/APP", rate: 0, note: "重點是折扣！平日刷卡 6 折起，假日 85 折 (需依當期活動)。" },
                                { cardName: "國泰 Cube", plan: "樂饗購", method: "實體卡", rate: 3.0, note: "無票價折扣，僅 3% 回饋。需切換至 [樂饗購]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "Line Pay", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "威秀影城 Vieshow",
                            category: "電影院",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "權益折扣", method: "實體/APP", rate: 0, note: "平日購票 7 折起 (依卡別等級而定)。" },
                                { cardName: "國泰 Cube", plan: "樂饗購", method: "實體卡", rate: 3.0, note: "無票價折扣，僅 3% 回饋。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "Line Pay", rate: 1.0, note: "一般回饋。" }
                            ]
                        },

                        // --- 國籍航空 ---
                        {
                            name: "China Airlines 中華航空",
                            category: "航空公司",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "注意：請切換至 [大筆刷] 方案 (非天天刷)。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "官網購票", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "EVA Air 長榮航空",
                            category: "航空公司",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "注意：請切換至 [大筆刷] 方案。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "官網購票", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "STARLUX 星宇航空",
                            category: "航空公司",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "注意：請切換至 [大筆刷] 方案。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "官網購票", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Tigerair Taiwan 台灣虎航",
                            category: "廉價航空",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "注意：請切換至 [大筆刷] 方案。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "官網購票", rate: 1.0, note: "一般回饋。" }
                            ]
                        },

                        // --- 日韓航空 ---
                        {
                            name: "Japan Airlines 日本航空 (JAL)",
                            category: "航空公司",
                            rewards: [
                                { cardName: "富邦 J 卡", plan: "日韓", method: "官網/日本", rate: 3.0, note: "若官網請款地為日本(日幣)享 3%，若為台幣則 1%。" },
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "需切換至 [大筆刷]。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" }
                            ]
                        },
                        {
                            name: "ANA 全日空",
                            category: "航空公司",
                            rewards: [
                                { cardName: "富邦 J 卡", plan: "日韓", method: "官網/日本", rate: 3.0, note: "若請款幣別為日幣享 3%。" },
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "需切換至 [大筆刷]。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" }
                            ]
                        },
                        {
                            name: "Peach Aviation 樂桃航空",
                            category: "廉價航空",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "需切換至 [大筆刷]。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "富邦 J 卡", plan: "一般/日韓", method: "官網", rate: 1.0, note: "視結帳幣別而定，通常為一般回饋。" }
                            ]
                        },
                        {
                            name: "Korean Air 大韓航空",
                            category: "航空公司",
                            rewards: [
                                { cardName: "富邦 J 卡", plan: "日韓", method: "官網/韓國", rate: 3.0, note: "若請款幣別為韓圜享 3%。" },
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "需切換至 [大筆刷]。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" }
                            ]
                        },

                        // --- 其他外籍航空 ---
                        {
                            name: "Cathay Pacific 國泰航空",
                            category: "航空公司",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "需切換至 [大筆刷]。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "官網購票", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Emirates 阿聯酋航空",
                            category: "航空公司",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "需切換至 [大筆刷]。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "官網購票", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Singapore Airlines 新加坡航空",
                            category: "航空公司",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "需切換至 [大筆刷]。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "官網購票", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "United Airlines 聯合航空",
                            category: "航空公司",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "需切換至 [大筆刷]。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "官網購票", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Scoot 酷航 / Jetstar 捷星 / AirAsia",
                            category: "廉價航空",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "需切換至 [大筆刷]。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "官網購票", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "VietJet Air 越捷航空",
                            category: "廉價航空",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "官網購票", rate: 3.8, note: "需切換至 [大筆刷]。" },
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "官網購票", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "官網購票", rate: 1.0, note: "一般回饋。" }
                            ]
                        },

                        // --- 訂房/旅遊平台 ---
                        {
                            name: "Agoda",
                            category: "訂房網",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "線上刷卡", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "線上刷卡", rate: 3.8, note: "Agoda為大筆刷指定通路，請切換至 [大筆刷]。" },
                                { cardName: "富邦 J 卡", plan: "日韓/一般", method: "線上", rate: 3.0, note: "若預訂日韓飯店且幣別正確享3%，否則1%。" }
                            ]
                        },
                        {
                            name: "Booking.com",
                            category: "訂房網",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "線上刷卡", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "線上刷卡", rate: 3.8, note: "指定訂房網，請切換至 [大筆刷]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "線上", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Airbnb",
                            category: "訂房網",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "線上刷卡", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "線上刷卡", rate: 3.8, note: "注意：Airbnb通常算海外交易，建議用 [大筆刷] 或海外方案。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "線上", rate: 1.0, note: "日韓以外一般回饋。" }
                            ]
                        },
                        {
                            name: "Klook 客路",
                            category: "旅遊體驗",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "線上刷卡", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "線上刷卡", rate: 3.8, note: "Klook 為指定通路，請切換至 [大筆刷]。" },
                                { cardName: "富邦 J 卡", plan: "日韓", method: "線上", rate: 3.0, note: "購買日韓商品且J卡有活動時享高回饋，否則1%。" }
                            ]
                        },
                        {
                            name: "KKday",
                            category: "旅遊體驗",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "線上刷卡", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "線上刷卡", rate: 3.8, note: "KKday 為指定通路，請切換至 [大筆刷]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "線上", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Trip.com",
                            category: "訂房機票",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "線上刷卡", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "線上刷卡", rate: 3.8, note: "指定通路，請切換至 [大筆刷]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "線上", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "ezTravel 易遊網",
                            category: "旅行社",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "趣旅行", method: "線上刷卡", rate: 3.0, note: "需切換至 [趣旅行]。" },
                                { cardName: "台新玫瑰太陽", plan: "大筆刷", method: "線上刷卡", rate: 3.8, note: "指定旅行社，請切換至 [大筆刷]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "線上", rate: 1.0, note: "一般回饋。" }
                            ]
                        },

                        // --- 境外電商 ---
                        {
                            name: "Coupang 酷澎 (台灣)",
                            category: "網購平台",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "玩數位", method: "APP刷卡", rate: 3.0, note: "需切換至 [玩數位]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "APP刷卡", rate: 1.0, note: "酷澎台灣刷卡通常視為國內一般消費。" },
                                { cardName: "台新玫瑰太陽", plan: "一般", method: "APP刷卡", rate: 0.3, note: "非指定通路 (除非是火箭跨境且判定為海外)。" }
                            ]
                        },
                        {
                            name: "Taobao / Tmall 淘寶/天貓",
                            category: "網購平台",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "玩數位", method: "線上刷卡", rate: 3.0, note: "需切換至 [玩數位]。" },
                                { cardName: "台新玫瑰太陽", plan: "海外", method: "線上刷卡", rate: 2.5, note: "視為海外交易，請切換至 [海外] 或大筆刷(若有)。需扣手續費。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "線上", rate: 1.0, note: "非日韓地區回饋低。" }
                            ]
                        },

                        // --- 超市/賣場 ---
                        {
                            name: "Carrefour 家樂福",
                            category: "超市量販",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "集精選", method: "實體卡", rate: 3.0, note: "需切換至 [集精選]。" },
                                { cardName: "台新玫瑰太陽", plan: "天天刷", method: "台新Pay", rate: 3.8, note: "需綁定台新 Pay。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "Line Pay", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "LOPIA 台灣",
                            category: "超市量販",
                            rewards: [
                                { cardName: "富邦 J 卡", plan: "一般", method: "實體卡", rate: 1.0, note: "LOPIA 僅收現金或少數信用卡(如聯名)，J卡視同一般消費。" },
                                { cardName: "國泰 Cube", plan: "一般", method: "實體卡", rate: 0.3, note: "非指定通路。" },
                                { cardName: "台新玫瑰太陽", plan: "一般", method: "實體卡", rate: 0.3, note: "非指定通路。" }
                            ]
                        },
                        {
                            name: "PX Mart 全聯福利中心",
                            category: "超市量販",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "一般", method: "PX Pay", rate: 0, note: "全聯已取消 Cube 高回饋。" },
                                { cardName: "台新玫瑰太陽", plan: "一般", method: "實體", rate: 0, note: "全聯不列入一般回饋。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "實體", rate: 0, note: "全聯不列入一般回饋。" }
                            ]
                        },
                        {
                            name: "Costco 好市多",
                            category: "超市量販",
                            rewards: [
                                { cardName: "富邦 J 卡", plan: "X", method: "X", rate: 0, note: "僅限富邦 Costco 聯名卡。" },
                                { cardName: "國泰 Cube", plan: "X", method: "X", rate: 0, note: "僅限富邦 Costco 聯名卡。" },
                                { cardName: "台新玫瑰太陽", plan: "X", method: "X", rate: 0, note: "僅限富邦 Costco 聯名卡。" }
                            ]
                        },

                        // --- 獨立分開的百貨 ---
                        {
                            name: "Shin Kong Mitsukoshi 新光三越",
                            category: "百貨公司",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "天天刷", method: "台新Pay", rate: 3.8, note: "必用台新Pay。" },
                                { cardName: "國泰 Cube", plan: "樂饗購", method: "實體卡", rate: 3.0, note: "切換 [樂饗購]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "刷卡", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "SOGO 遠東SOGO",
                            category: "百貨公司",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "樂饗購", method: "實體卡", rate: 3.0, note: "切換 [樂饗購]。" },
                                { cardName: "台新玫瑰太陽", plan: "天天刷", method: "台新Pay", rate: 3.8, note: "必用台新Pay。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "刷卡", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Far Eastern 遠東百貨 (大遠百)",
                            category: "百貨公司",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "樂饗購", method: "實體卡", rate: 3.0, note: "切換 [樂饗購]。" },
                                { cardName: "台新玫瑰太陽", plan: "天天刷", method: "台新Pay", rate: 3.8, note: "必用台新Pay。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "刷卡", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Breeze 微風廣場",
                            category: "百貨公司",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "天天刷", method: "台新Pay", rate: 3.8, note: "必用台新Pay。" },
                                { cardName: "國泰 Cube", plan: "樂饗購", method: "實體卡", rate: 3.0, note: "切換 [樂饗購]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "刷卡", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Taipei 101 台北101",
                            category: "百貨公司",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "天天刷", method: "台新Pay", rate: 3.8, note: "必用台新Pay。" },
                                { cardName: "國泰 Cube", plan: "樂饗購", method: "實體卡", rate: 3.0, note: "切換 [樂饗購]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "刷卡", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Hanshin 漢神百貨",
                            category: "百貨公司",
                            rewards: [
                                { cardName: "台新玫瑰太陽", plan: "天天刷", method: "台新Pay", rate: 3.8, note: "必用台新Pay。" },
                                { cardName: "國泰 Cube", plan: "樂饗購", method: "實體卡", rate: 3.0, note: "切換 [樂饗購]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "刷卡", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Big City 遠東巨城",
                            category: "百貨公司",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "樂饗購", method: "實體卡", rate: 3.0, note: "切換 [樂饗購]。" },
                                { cardName: "台新玫瑰太陽", plan: "天天刷", method: "台新Pay", rate: 3.8, note: "必用台新Pay。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "刷卡", rate: 1.0, note: "一般回饋。" }
                            ]
                        },
                        {
                            name: "Focus 時尚流行館 (台南)",
                            category: "百貨公司",
                            rewards: [
                                { cardName: "國泰 Cube", plan: "樂饗購", method: "實體卡", rate: 3.0, note: "切換 [樂饗購]。" },
                                { cardName: "富邦 J 卡", plan: "一般", method: "Line Pay", rate: 1.0, note: "綁定 Line Pay。" },
                                { cardName: "台新玫瑰太陽", plan: "一般", method: "刷卡", rate: 0.3, note: "非指定通路。" }
                            ]
                        }
                    ]
                }
            },
            computed: {
                filteredMerchants() {
                    if (!this.searchQuery) return [];
                    const query = this.searchQuery.toLowerCase();
                    return this.merchants.filter(m => 
                        m.name.toLowerCase().includes(query) || m.category.toLowerCase().includes(query)
                    );
                },
                sortedRewards() {
                    if (!this.selectedMerchant) return [];
                    return [...this.selectedMerchant.rewards].sort((a, b) => b.rate - a.rate);
                }
            },
            methods: {
                handleInput() { this.selectedMerchant = null; },
                quickSearch(term) { this.searchQuery = term; this.selectedMerchant = null; },
                selectMerchant(merchant) { this.selectedMerchant = merchant; },
                backToSearch() { this.selectedMerchant = null; },
                clearSearch() { this.searchQuery = ''; this.selectedMerchant = null; },
                
                getIconClass(category) {
                    if (category.includes('國外') || category.includes('航空')) return 'fa-solid fa-plane';
                    if (category.includes('廉價航空')) return 'fa-solid fa-plane-slash';
                    if (category.includes('網購') || category.includes('訂房')) return 'fa-solid fa-laptop';
                    if (category.includes('電影')) return 'fa-solid fa-film';
                    if (category.includes('超市') || category.includes('便利商店')) return 'fa-solid fa-basket-shopping';
                    if (category.includes('百貨')) return 'fa-solid fa-bag-shopping';
                    return 'fa-solid fa-store';
                },
                getIconColor(category) {
                    if (category.includes('航空')) return 'bg-sky-50 text-sky-500';
                    if (category.includes('網購')) return 'bg-indigo-50 text-indigo-500';
                    if (category.includes('電影')) return 'bg-pink-50 text-pink-500';
                    if (category.includes('百貨')) return 'bg-purple-50 text-purple-500';
                    return 'bg-slate-100 text-slate-500';
                },
                getTextColorClass(cardName) {
                    if (cardName.includes("Cube")) return "text-emerald-600";
                    if (cardName.includes("台新")) return "text-rose-500";
                    if (cardName.includes("富邦")) return "text-blue-500";
                    return "text-slate-600";
                },
                getRateColorClass(cardName) {
                    if (cardName.includes("Cube")) return "text-emerald-500";
                    if (cardName.includes("台新")) return "text-rose-500";
                    if (cardName.includes("富邦")) return "text-blue-500";
                    return "text-slate-400";
                },
                getMethodTagClass(method) {
                    if (method.includes("Pay") || method.includes("APP")) return "bg-green-50 text-green-600 border-green-100";
                    if (method.includes("官網") || method.includes("線上")) return "bg-blue-50 text-blue-600 border-blue-100";
                    if (method === "X") return "bg-red-50 text-red-500 border-red-100";
                    return "bg-slate-50 text-slate-500 border-slate-200";
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
